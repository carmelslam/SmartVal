<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Developer Module - Evalix - SmartVal Pro System</title>
  <link rel="icon" type="image/webp" href="https://carmelcayouf.com/wp-content/uploads/2025/06/g.webp">
  <link rel="apple-touch-icon" href="https://carmelcayouf.com/wp-content/uploads/2025/06/g.webp">
  <link rel="shortcut icon" href="https://carmelcayouf.com/wp-content/uploads/2025/06/g.webp">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 50%, #1a1a1a 100%);
      margin: 0;
      padding: 20px;
      direction: rtl;
      text-align: right;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: #0d1117;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      overflow: hidden;
      border: 1px solid #30363d;
    }

    .header {
      background: linear-gradient(135deg, #0d1117, #21262d);
      color: #58a6ff;
      padding: 30px;
      text-align: center;
      border-bottom: 3px solid #00d4aa;
    }

    .header .logo {
      width: 60px;
      height: 60px;
      margin-bottom: 15px;
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(0, 212, 170, 0.3);
    }

    .header .business-name {
      margin: 0;
      font-size: 28px;
      font-weight: 600;
      color: #58a6ff;
    }

    .header .business-subtitle {
      margin: 8px 0 15px 0;
      opacity: 0.9;
      font-size: 16px;
      color: #7d8590;
    }

    .header .page-title {
      margin: 0;
      font-size: 24px;
      font-weight: 400;
      color: #00d4aa;
    }

    .header .subtitle {
      margin: 10px 0 0 0;
      opacity: 0.8;
      font-size: 14px;
      color: #7d8590;
    }

    .nav-tabs {
      display: flex;
      background: #161b22;
      border-bottom: 1px solid #30363d;
    }

    .nav-tab {
      flex: 1;
      padding: 15px 20px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      color: #7d8590;
      transition: all 0.3s ease;
    }

    .nav-tab.active {
      background: #21262d;
      color: #00d4aa;
      border-bottom: 3px solid #00d4aa;
    }

    .nav-tab:hover {
      background: #30363d;
      color: #58a6ff;
    }

    .content {
      padding: 30px;
      background: #0d1117;
      color: #e6edf3;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .config-section {
      margin-bottom: 30px;
      padding: 25px;
      border: 1px solid #30363d;
      border-radius: 10px;
      background: #161b22;
    }

    .config-section h3 {
      margin: 0 0 20px 0;
      color: #58a6ff;
      font-size: 20px;
      border-bottom: 2px solid #00d4aa;
      padding-bottom: 10px;
    }

    .config-row {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .config-field {
      flex: 1;
      min-width: 250px;
    }

    .config-field label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #e6edf3;
    }

    .config-field input,
    .config-field select,
    .config-field textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #30363d;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s ease;
      box-sizing: border-box;
      background: #21262d;
      color: #e6edf3;
    }

    .config-field input:focus,
    .config-field select:focus,
    .config-field textarea:focus {
      outline: none;
      border-color: #00d4aa;
      box-shadow: 0 0 0 3px rgba(0, 212, 170, 0.1);
    }

    .config-field input[type="password"] {
      background: #3d2914;
      border-color: #58a6ff;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 34px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: #2196F3;
    }

    input:checked + .slider:before {
      transform: translateX(26px);
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: white;
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #2980b9, #21618c);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
    }

    .btn-success {
      background: linear-gradient(135deg, #27ae60, #229954);
      color: white;
    }

    .btn-success:hover {
      background: linear-gradient(135deg, #229954, #1e8449);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
    }

    .btn-danger {
      background: linear-gradient(135deg, #e74c3c, #c0392b);
      color: white;
    }

    .btn-danger:hover {
      background: linear-gradient(135deg, #c0392b, #a93226);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
    }

    .action-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-top: 30px;
      padding: 20px;
      background: #161b22;
      border-radius: 10px;
      border: 1px solid #30363d;
    }

    .alert {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: none;
    }

    .alert.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .alert.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .alert.warning {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }

    .alert.show {
      display: block;
    }

    .webhook-test {
      background: #1c2c1c;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      border: 1px solid #00d4aa;
    }

    .webhook-test h4 {
      color: #00d4aa;
      margin: 0 0 10px 0;
    }

    .test-result {
      background: #21262d;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #30363d;
      margin-top: 10px;
      font-family: monospace;
      font-size: 12px;
      color: #e6edf3;
    }

    .config-preview {
      background: #21262d;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #30363d;
      font-family: monospace;
      font-size: 12px;
      max-height: 300px;
      overflow-y: auto;
      color: #e6edf3;
    }

    .footer {
      background: #0d1117;
      color: #7d8590;
      text-align: center;
      padding: 20px;
      border-top: 1px solid #30363d;
      font-size: 14px;
    }

    @media (max-width: 768px) {
      .config-row {
        flex-direction: column;
      }
      
      .action-buttons {
        flex-direction: column;
      }
      
      .action-buttons .btn {
        margin-bottom: 10px;
      }

      .nav-tabs {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <img src="https://carmelcayouf.com/wp-content/uploads/2025/06/g.webp" alt="Logo" class="logo">
      <h1 class="business-name">Evalix - SmartVal Pro System</h1>
      <div class="business-subtitle">Vehicle Appraisal & Damage Assessment</div>
      <h2 class="page-title">ğŸ”§ Developer Module</h2>
      <div class="subtitle">System Configuration & Advanced Settings</div>
    </div>

    <div class="nav-tabs">
      <button class="nav-tab active" onclick="switchTab('webhooks')">Webhooks</button>
      <button class="nav-tab" onclick="switchTab('api-keys')">××¤×ª×—×•×ª API</button>
      <button class="nav-tab" onclick="switchTab('system')">×”×’×“×¨×•×ª ××¢×¨×›×ª</button>
      <button class="nav-tab" onclick="switchTab('text-overrides')">×¢×¨×™×›×ª ×˜×§×¡×˜×™×</button>
      <button class="nav-tab" onclick="switchTab('backup')">×’×™×‘×•×™ ×•×©×—×–×•×¨</button>
      <button class="nav-tab" onclick="window.location.href='test-dashboard.html'">ğŸ§ª ×œ×•×— ×‘×§×¨×ª ×‘×“×™×§×•×ª ××™× ×˜×’×¨×¦×™×”</button>
    </div>

    <div class="content">
      <div id="alerts"></div>

      <!-- Webhooks Tab -->
      <div id="webhooks" class="tab-content active">
        <div class="config-section">
          <h3>ğŸ”— ×”×’×“×¨×•×ª Webhooks</h3>
          <div class="config-row">
            <div class="config-field">
              <label>Make.com Base URL:</label>
              <input type="url" id="makecom-base-url" placeholder="https://hook.integromat.com/...">
            </div>
            <div class="config-field">
              <label>Webhook Timeout (seconds):</label>
              <input type="number" id="webhook-timeout" value="30" min="5" max="120">
            </div>
          </div>
          <div class="config-row">
            <div class="config-field">
              <label>Expertise Export Webhook:</label>
              <input type="url" id="expertise-webhook" placeholder="/expertise-export">
            </div>
            <div class="config-field">
              <label>Final Report Webhook:</label>
              <input type="url" id="final-report-webhook" placeholder="/final-report">
            </div>
          </div>
          <div class="config-row">
            <div class="config-field">
              <label>Estimate Report Webhook:</label>
              <input type="url" id="estimate-webhook" placeholder="/estimate-report">
            </div>
          </div>
          <div class="webhook-test">
            <h4>×‘×“×™×§×ª Webhook</h4>
            <button class="btn btn-primary" onclick="testWebhook()">×‘×“×•×§ ×—×™×‘×•×¨</button>
            <div class="test-result" id="webhook-test-result"></div>
          </div>
        </div>
      </div>

      <!-- API Keys Tab -->
      <div id="api-keys" class="tab-content">
        <div class="config-section">
          <h3>ğŸ”‘ ××¤×ª×—×•×ª API</h3>
          <div class="config-row">
            <div class="config-field">
              <label>Cloudinary Cloud Name:</label>
              <input type="text" id="cloudinary-cloud-name" placeholder="your-cloud-name">
            </div>
            <div class="config-field">
              <label>Cloudinary API Key:</label>
              <input type="password" id="cloudinary-api-key" placeholder="123456789012345">
            </div>
          </div>
          <div class="config-row">
            <div class="config-field">
              <label>Cloudinary API Secret:</label>
              <input type="password" id="cloudinary-api-secret" placeholder="your-api-secret">
            </div>
            <div class="config-field">
              <label>Cloudinary Upload Preset:</label>
              <input type="text" id="cloudinary-upload-preset" placeholder="unsigned_preset">
            </div>
          </div>
          <div class="config-row">
            <div class="config-field">
              <label>OCR Service API Key:</label>
              <input type="password" id="ocr-api-key" placeholder="ocr-service-key">
            </div>
            <div class="config-field">
              <label>OCR Service Endpoint:</label>
              <input type="url" id="ocr-endpoint" placeholder="https://api.ocr-service.com/v1">
            </div>
          </div>
        </div>
      </div>

      <!-- System Settings Tab -->
      <div id="system" class="tab-content">
        <div class="config-section">
          <h3>âš™ï¸ ×”×’×“×¨×•×ª ××¢×¨×›×ª</h3>
          <div class="config-row">
            <div class="config-field">
              <label>××¦×‘ ×¤×™×ª×•×— (Debug Mode):</label>
              <label class="toggle-switch">
                <input type="checkbox" id="debug-mode">
                <span class="slider"></span>
              </label>
            </div>
            <div class="config-field">
              <label>××¦×‘ ×‘×“×™×§×•×ª (Test Mode):</label>
              <label class="toggle-switch">
                <input type="checkbox" id="test-mode">
                <span class="slider"></span>
              </label>
            </div>
          </div>
          <div class="config-row">
            <div class="config-field">
              <label>××¡×¤×¨ ×™××™ ×’×™×‘×•×™ ××•×˜×•××˜×™:</label>
              <input type="number" id="backup-days" value="7" min="1" max="30">
            </div>
            <div class="config-field">
              <label>××’×‘×œ×ª ×’×•×“×œ ×§×•×‘×¥ (MB):</label>
              <input type="number" id="max-file-size" value="50" min="1" max="500">
            </div>
          </div>
          <div class="config-row">
            <div class="config-field">
              <label>×©×¤×ª ×‘×¨×™×¨×ª ××—×“×œ:</label>
              <select id="default-language">
                <option value="he">×¢×‘×¨×™×ª</option>
                <option value="en">English</option>
              </select>
            </div>
            <div class="config-field">
              <label>××–×•×¨ ×–××Ÿ:</label>
              <select id="timezone">
                <option value="Asia/Jerusalem">×™×¨×•×©×œ×™×</option>
                <option value="UTC">UTC</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <!-- Text Overrides Tab -->
      <div id="text-overrides" class="tab-content">
        <div class="config-section">
          <h3>ğŸ“ ×¢×¨×™×›×ª ×˜×§×¡×˜×™× ××©×¤×˜×™×™×</h3>
          <div class="config-row">
            <div class="config-field">
              <label>××¤×©×¨ ×¢×¨×™×›×ª ×˜×§×¡×˜×™×:</label>
              <label class="toggle-switch">
                <input type="checkbox" id="enable-text-override">
                <span class="slider"></span>
              </label>
            </div>
            <div class="config-field">
              <label>×’×¨×¡×ª ×˜×§×¡×˜×™× ×¤×¢×™×œ×”:</label>
              <select id="active-text-version">
                <option value="production">×™×™×¦×•×¨</option>
                <option value="staging">×‘×“×™×§×•×ª</option>
                <option value="custom">××•×ª×× ××™×©×™×ª</option>
              </select>
            </div>
          </div>
          <div class="config-row">
            <div class="config-field">
              <label>×˜×§×¡×˜ ×—×•×•×ª ×“×¢×ª ×¤×¨×˜×™×ª:</label>
              <textarea id="private-expert-text" rows="4" placeholder="×”×˜×§×¡×˜ ×”××©×¤×˜×™ ×œ×—×•×•×ª ×“×¢×ª ×¤×¨×˜×™×ª..."></textarea>
            </div>
            <div class="config-field">
              <label>×˜×§×¡×˜ ××•××“×Ÿ - ××•×‘×“×Ÿ ×œ×”×œ×›×”:</label>
              <textarea id="estimate-loss-text" rows="4" placeholder="×”×˜×§×¡×˜ ×”××©×¤×˜×™ ×œ××•××“×Ÿ ××•×‘×“×Ÿ ×œ×”×œ×›×”..."></textarea>
            </div>
          </div>
          <div class="config-row">
            <div class="config-field">
              <label>×˜×§×¡×˜ ××•××“×Ÿ - ×˜×•×˜×œ×•×¡:</label>
              <textarea id="estimate-total-text" rows="4" placeholder="×”×˜×§×¡×˜ ×”××©×¤×˜×™ ×œ××•××“×Ÿ ×˜×•×˜×œ×•×¡..."></textarea>
            </div>
          </div>
        </div>
      </div>

      <!-- Backup & Restore Tab -->
      <div id="backup" class="tab-content">
        <div class="config-section">
          <h3>ğŸ’¾ ×’×™×‘×•×™ ×•×©×—×–×•×¨ ×”×’×“×¨×•×ª</h3>
          <div class="config-row">
            <div class="config-field">
              <label>×™×¦×•× ×”×’×“×¨×•×ª × ×•×›×—×™×•×ª:</label>
              <button class="btn btn-primary" onclick="exportConfig()">×™×¦× ×”×’×“×¨×•×ª</button>
            </div>
            <div class="config-field">
              <label>×™×™×‘×•× ×”×’×“×¨×•×ª:</label>
              <input type="file" id="config-import" accept=".json">
              <button class="btn btn-success" onclick="importConfig()">×™×™×‘× ×”×’×“×¨×•×ª</button>
            </div>
          </div>
          <div class="config-row">
            <div class="config-field">
              <label>××™×¤×•×¡ ×œ×”×’×“×¨×•×ª ×‘×¨×™×¨×ª ××—×“×œ:</label>
              <button class="btn btn-danger" onclick="resetToDefaults()">××™×¤×•×¡ ×›×œ×œ×™</button>
            </div>
          </div>
          <div class="config-preview" id="config-preview">
            <strong>×ª×¦×•×’×” ××§×“×™××” ×©×œ ×”×’×“×¨×•×ª × ×•×›×—×™×•×ª:</strong>
            <pre id="config-preview-content"></pre>
          </div>
        </div>
      </div>

      <div class="action-buttons">
        <button class="btn btn-success" onclick="saveConfiguration()">ğŸ’¾ ×©××•×¨ ×”×’×“×¨×•×ª</button>
        <button class="btn btn-primary" onclick="loadConfiguration()">ğŸ”„ ×˜×¢×Ÿ ×”×’×“×¨×•×ª</button>
        <button class="btn btn-danger" onclick="window.location.href='selection.html'">ğŸšª ×™×¦×™××”</button>
      </div>
    </div>
    
    <div class="footer">
      @2025 Evalix. All rights reserved. SmartVal Pro System Â©
    </div>
  </div>

  <script type="module" src="./dev-config.js"></script>
  <script>
    // Tab switching functionality
    function switchTab(tabName) {
      // Hide all tab contents
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });
      
      // Remove active class from all nav tabs
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Show selected tab content
      document.getElementById(tabName).classList.add('active');
      
      // Mark selected nav tab as active
      event.target.classList.add('active');
    }

    // Alert functionality
    function showAlert(message, type = 'success') {
      const alertsContainer = document.getElementById('alerts');
      const alert = document.createElement('div');
      alert.className = `alert ${type} show`;
      alert.textContent = message;
      alertsContainer.appendChild(alert);
      
      setTimeout(() => {
        alert.remove();
      }, 5000);
    }

    // Phase 6: Role-based authentication check
    document.addEventListener('DOMContentLoaded', () => {
      console.log('ğŸ” Checking developer access for dev-module...');
      
      const authData = sessionStorage.getItem('auth');
      if (!authData) {
        alert('× ×“×¨×©×ª ×”×ª×—×‘×¨×•×ª ×œ××¢×¨×›×ª');
        window.location.href = 'index.html';
        return;
      }
      
      try {
        const auth = JSON.parse(authData);
        const userRole = auth?.profile?.role;
        
        if (userRole !== 'developer') {
          console.log('âŒ User role not authorized for dev module:', userRole);
          alert('××™×Ÿ ×œ×š ×”×¨×©××” ×œ×’×©×ª ×œ××•×“×•×œ ×”××¤×ª×—×™×.\n\n× ×“×¨×©×ª ×”×¨×©××ª ××¤×ª×— ×‘×œ×‘×“.');
          window.location.href = 'admin.html';
          return;
        }
        
        console.log('âœ… Developer access verified for:', auth.profile.name);
      } catch (e) {
        console.error('Failed to verify dev access:', e);
        alert('×©×’×™××” ×‘××™××•×ª ×”×¨×©××•×ª');
        window.location.href = 'index.html';
        return;
      }

      // Load current configuration
      loadConfiguration();
      updateConfigPreview();
    });

    // Placeholder functions - will be implemented in dev-config.js
    window.testWebhook = function() { console.log('Testing webhook...'); };
    window.saveConfiguration = function() { console.log('Saving configuration...'); };
    window.loadConfiguration = function() { console.log('Loading configuration...'); };
    window.exportConfig = function() { console.log('Exporting config...'); };
    window.importConfig = function() { console.log('Importing config...'); };
    window.resetToDefaults = function() { console.log('Resetting to defaults...'); };
    window.updateConfigPreview = function() { console.log('Updating preview...'); };
  </script>
</body>
</html>